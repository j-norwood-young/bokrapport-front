!function(a,b){"object"==typeof exports?module.exports=b(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],b):a.Draggable=b(a.jQuery)}(this,function(a){"use strict";function b(b,d){var e=this,f=c(e.start,e),g=c(e.drag,e),i=c(e.stop,e);if(!h(b))throw new TypeError("Draggable expects argument 0 to be an Element");a.extend(e,{element:b,$element:a(b),handlers:{start:l.touch?{touchstart:f}:{mousedown:f},move:l.touch?{touchmove:g,touchend:i}:{mousemove:g,mouseup:i}},options:a.extend({},k,d)}),e.initialize()}function c(a,b){return function(){a.apply(b,arguments)}}function d(a){return parseInt(a,10)}function e(a){return l.ie?a.currentStyle:getComputedStyle(a)}function f(a){return a instanceof Array}function g(a){return void 0!==a&&null!==a}function h(a){return a instanceof Element||a instanceof HTMLDocument}function i(a){return a instanceof Function}function j(){}var k={grid:0,filterTarget:null,limit:{x:null,y:null},threshold:0,setCursor:!1,setPosition:!0,smoothDrag:!0,useGPU:!0,onDrag:j,onDragStart:j,onDragEnd:j},l={touch:"ontouchstart"in window||"DocumentTouch"in window&&document instanceof DocumentTouch,ie:"Microsoft Internet Explorer"===navigator.appName,transform:function(){for(var a=" -o- -ms- -moz- -webkit-".split(" "),b=document.body.style,c=a.length;c--;){var d=a[c]+"transform";if(d in b)return d}}()},m=a(document);return a.extend(b.prototype,{setOption:function(a,b){var c=this;return c.options[a]=b,c.initialize(),c},get:function(){var a=this.dragEvent;return{x:a.x,y:a.y}},set:function(a,b){var c=this,d=c.dragEvent;return d.original={x:d.x,y:d.y},c.move(a,b),c},dragEvent:{started:!1,x:0,y:0},initialize:function(){var b,c=this,d=c.element,f=d.style,g=e(d),h=c.options,i=l.transform,j=c._dimensions={height:d.offsetHeight,left:d.offsetLeft,top:d.offsetTop,width:d.offsetWidth};h.useGPU&&i&&(b=g[i],"none"===b&&(b=""),f[i]=b+" translate3d(0,0,0)"),h.setPosition&&(f.display="block",f.left=j.left+"px",f.top=j.top+"px",f.bottom=f.right="auto",f.margin=0,f.position="absolute"),h.setCursor&&(f.cursor="move"),c.setLimit(h.limit),a.extend(c.dragEvent,{x:j.left,y:j.top}),c.$element.on(c.handlers.start)},start:function(a){var b=this,c=b.getCursor(a),d=b.element;b.useTarget(a.target)&&(a.preventDefault?a.preventDefault():a.returnValue=!1,b.dragEvent.oldZindex=d.style.zIndex,d.style.zIndex=1e4,b.setCursor(c),b.setPosition(),b.setZoom(),m.on(b.handlers.move))},drag:function(a){var b=this,c=b.dragEvent,d=b.element,e=b._cursor,f=b._dimensions,g=b.options,h=f.zoom,i=b.getCursor(a),j=g.threshold,k=(i.x-e.x)/h+f.left,l=(i.y-e.y)/h+f.top;!c.started&&j&&Math.abs(e.x-i.x)<j&&Math.abs(e.y-i.y)<j||(c.original||(c.original={x:k,y:l}),c.started||(g.onDragStart(d,k,l,a),c.started=!0),b.move(k,l)&&g.onDrag(d,c.x,c.y,a))},move:function(a,b){var c=this,d=c.dragEvent,e=c.options,f=e.grid,g=c.element.style,h=c.limit(a,b,d.original.x,d.original.y);return!e.smoothDrag&&f&&(h=c.round(h,f)),h.x!==d.x||h.y!==d.y?(d.x=h.x,d.y=h.y,g.left=h.x+"px",g.top=h.y+"px",!0):!1},stop:function(b){var c,d=this,e=d.dragEvent,f=d.element,g=d.options,h=g.grid;m.off(d.handlers.move),f.style.zIndex=e.oldZindex,g.smoothDrag&&h&&(c=d.round({x:e.x,y:e.y},h),d.move(c.x,c.y),a.extend(d.dragEvent,c)),d.dragEvent.started&&g.onDragEnd(f,e.x,e.y,b),d.reset()},reset:function(){this.dragEvent.started=!1},round:function(a){var b=this.options.grid;return{x:b*Math.round(a.x/b),y:b*Math.round(a.y/b)}},getCursor:function(a){return{x:(l.touch?a.targetTouches[0]:a).clientX,y:(l.touch?a.targetTouches[0]:a).clientY}},setCursor:function(a){this._cursor=a},setLimit:function(a){var b=this,c=function(a,b){return{x:a,y:b}};if(i(a))b.limit=a;else if(h(a)){var d=b._dimensions,e=a.scrollHeight-d.height,j=a.scrollWidth-d.width;b.limit=function(a,b){return 0>a?a=0:a>j&&(a=j),0>b?b=0:b>e&&(b=e),{x:a,y:b}}}else if(a){var k,l,m={x:g(a.x),y:g(a.y)};m.x||m.y?m.x&&!m.y?f(a.x)?(k=[+a.x[0],+a.x[1]],b.limit=function(a,b){return a<k[0]?a=k[0]:a>k[1]&&(a=k[1]),{x:a,y:b}}):(k=+a.x,b.limit=function(a,b){return{x:k,y:b}}):!m.x&&m.y?f(a.y)?(l=[+a.y[0],+a.y[1]],b.limit=function(a,b){return b<l[0]?b=l[0]:b>l[1]&&(b=l[1]),{x:a,y:b}}):(l=+a.y,b.limit=function(a){return{x:a,y:l}}):f(a.x)&&f(a.y)?(k=[+a.x[0],+a.x[1]],l=[+a.y[0],+a.y[1]],b.limit=function(a,b){return a<k[0]?a=k[0]:a>k[1]&&(a=k[1]),b<l[0]?b=l[0]:b>l[1]&&(b=l[1]),{x:a,y:b}}):f(a.x)?(k=[+a.x[0],+a.x[1]],l=+a.y,b.limit=function(a){return a<k[0]?a=k[0]:a>k[1]&&(a=k[1]),{x:a,y:l}}):f(a.y)?(k=+a.x,l=[+a.y[0],+a.y[1]],b.limit=function(a,b){return b<l[0]?b=l[0]:b>l[1]&&(b=l[1]),{x:k,y:b}}):(k=+a.x,l=+a.y,b.limit=function(){return{x:k,y:l}}):b.limit=c}else b.limit=c},setPosition:function(){var b=this,c=b.element,e=c.style;a.extend(b._dimensions,{left:d(e.left)||c.offsetLeft,top:d(e.top)||c.offsetTop})},setZoom:function(){for(var a=this,b=a.element,c=1;b=b.offsetParent;){var d=e(b).zoom;if(d&&"normal"!==d){c=d;break}}a._dimensions.zoom=c},useTarget:function(a){var b=this.options.filterTarget;return b instanceof Function?b(a):!0},destroy:function(){this.$element.off(this.handlers.start),m.off(this.handlers.move)}}),b});